/**
(c) 2012 Uzi Kilon, Splunk Inc.
Backbone Poller 0.2.1
https://github.com/uzikilon/backbone-poller
Backbone Poller may be freely distributed under the MIT license.
*/var Backbone,_;if(!Backbone||!_)throw new Error("Backbone.js and underscore.js are required dependancies");(function(){"use strict";function r(e){return _.find(n,function(t){return t.model===e})}function s(e,t){this.model=e,this.set(t)}function o(e){if(e.active()!==!0){e.stop({silent:!0});return}var t=_.extend({data:e.options.data},{success:function(){e.trigger("success",e.model),e.options.condition(e.model)!==!0?(e.stop({silent:!0}),e.trigger("complete",e.model)):e.timeoutId=_.delay(o,e.options.delay,e)},error:function(){e.stop({silent:!0}),e.trigger("error",e.model)}});e.trigger("fetch",e.model),e.xhr=e.model.fetch(t)}var e={delay:1e3,condition:function(){return!0}},t=["start","stop","fetch","success","error","complete"],n=[],i={get:function(e,t){var i=r(e);return i?i.set(t):(i=new s(e,t),n.push(i)),t&&t.autostart===!0&&i.start({silent:!0}),i},getPoller:function(){return window.console&&window.console.warn("getPoller() is depreacted, Use Backbone.Poller.get()"),this.get.apply(this,arguments)},size:function(){return n.length},reset:function(){while(n.length)n.pop().stop()}};return _.extend(s.prototype,Backbone.Events,{set:function(n){return this.off(),this.options=_.extend({},e,n||{}),_.each(t,function(e){var t=this.options[e];_.isFunction(t)&&this.on(e,t,this)},this),this.model instanceof Backbone.Model&&this.model.on("destroy",this.stop,this),this.stop({silent:!0})},start:function(e){return this.active()||(e=e||{},e.silent||this.trigger("start",this.model),this.options.active=!0,o(this)),this},stop:function(e){return e=e||{},e.silent||this.trigger("stop",this.model),this.options.active=!1,this.xhr&&_.isFunction(this.xhr.abort)&&this.xhr.abort(),this.xhr=null,clearTimeout(this.timeoutId),this.timeoutId=null,this},active:function(){return this.options.active===!0}}),window.PollingManager=i,Backbone.Poller=i,i})();